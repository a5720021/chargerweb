<script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
<!-- <script src="https://www.gstatic.com/firebasejs/4.9.1/firebase-app.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/4.9.1/firebase-auth.js"></script> -->
<script src="https://www.gstatic.com/firebasejs/4.9.1/firebase-database.js"></script>

<script>
    class Firebase {

        constructor() {
            var config = {
                apiKey: "AIzaSyDpBtpDYu0a4roRChP0yWBgAu9yPB3lrjc",
                authDomain: "ocpp-database.firebaseapp.com",
                databaseURL: "https://ocpp-database.firebaseio.com",
                storageBucket: "ocpp-database.appspot.com",
            };
            firebase.initializeApp(config);
        }

        test() {
            console.log("test");
        }

        db() {
            return firebase.database();
        }

        allMarker(callback) {
            var arr = [];
            fb.db().ref('/chargerstation').on('value', function (snapshot) {
                snapshot.forEach(function (childSnapshot) {
                    var cpid = childSnapshot.key;
                    var childData = childSnapshot.val();
                    arr.push({ id: cpid, pos: childData.position, con: childData.connector });
                });
                callback(arr);
            });
        }
        checkLogin(email, pass, callback, error) {
            console.log(email, pass);
            // var arr = [];
            fb.db().ref('authorize').orderByChild('email').equalTo(email).on('value', function (snapshot) {
                //console.log(snapshot.val());
                snapshot.forEach(function (childSnapshot) {
                    console.log(childSnapshot.val());
                    if (childSnapshot.val().password == pass && childSnapshot.val().email == email) {
                        callback({email: childSnapshot.val().email});
                    } else {
                        error("Error");
                    }
                });
            });
        }
        displayData(callback) {
            var email_user = localStorage.getItem("email");
            if (localStorage.getItem("email") != null || localStorage.getItem("email") != undefined) {
                fb.db().ref('authorize').orderByChild('email').equalTo(email_user).on('value', function (snapshot) {
                    snapshot.forEach(function (childSnapshot) {
                        callback({ tag: childSnapshot.key, email: childSnapshot.val().email, amount: childSnapshot.val().amount });
                    });
                });
            }
        }
    }


    window.fb = new Firebase();

</script>
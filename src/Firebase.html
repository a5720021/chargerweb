<script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
<!-- <script src="https://www.gstatic.com/firebasejs/4.9.1/firebase-app.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/4.9.1/firebase-auth.js"></script> -->
<script src="https://www.gstatic.com/firebasejs/4.9.1/firebase-database.js"></script>

<script>
    class Firebase {

        constructor() {
            var config = {
                apiKey: "AIzaSyDpBtpDYu0a4roRChP0yWBgAu9yPB3lrjc",
                authDomain: "ocpp-database.firebaseapp.com",
                databaseURL: "https://ocpp-database.firebaseio.com",
                storageBucket: "ocpp-database.appspot.com",
            };
            firebase.initializeApp(config);
        }

        test() {
            console.log("test");
        }

        db() {
            return firebase.database();
        }

        allMarker(callback) {
            var arr = [];
            fb.db().ref('/chargerstation').on('value', function(snapshot) {
                snapshot.forEach(function(childSnapshot) {
                    var cpid = childSnapshot.key;
                    var childData = childSnapshot.val();
                    arr.push({id:cpid,pos:childData.position,con:childData.connector});
                });
                callback(arr);
            });
        }
        checkLogin(email,pass,callback,error) {
            console.log(email,pass);
            // var arr = [];
            fb.db().ref('authorize').orderByChild('email').equalTo(email).on('value', function (snapshot) {
                //console.log(snapshot.val());
                snapshot.forEach(function (childSnapshot) {
                    console.log(childSnapshot.val());
                    if(childSnapshot.val().password == pass && childSnapshot.val().email == email){
                        callback({tag:childSnapshot.key,email:childSnapshot.val().email,amount:childSnapshot.val().amount});
                    }else{
                        error("Error");
                    }
                });
            });
        }
    }

    window.fb = new Firebase();

</script>